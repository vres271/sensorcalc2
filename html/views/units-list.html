<nav class="navbar navbar-fluide navbar-fixed-top marg-1 bg-white" >
	<div class="container-fluide">
		<form action="" class="navbar-form ">
			<!-- <div ng-hide="!items_checked" class="form-group"> -->
			    <!-- <div class="btn-group"> -->
			      <!-- <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown"><i class="fa fa-check" data-toggle="dropdown"></i> <span  translate>with selected</span>... <span class="caret"></span></button> -->
			      <!-- <ul class="dropdown-menu" role="menu"> -->
			        <!-- <li><a href="" ng-href="#about/admin">{{'Backup and remove units'|translate}} <sup><span class="label label-primary">CRM</span></sup></a></li> -->
			        <!-- <li><a href="" ng-href="#about/admin">{{'Move to another account'|translate}} <sup><span class="label label-primary">CRM</span></sup></a></li> -->
			        <!-- <li class="divider"></li> -->
			        <!-- <li><a href="" ng-href="#about/support">{{'Plan work'|translate}} <sup><span class="label label-primary">CRM</span></sup></a></li> -->
			        <!-- <li><a href="" ng-href="#about/support">{{'Register results'|translate}} <sup><span class="label label-primary">CRM</span></sup></a></li> -->
			        <!-- <li><a href="" ng-href="#about/support">{{'Show events history'|translate}} <sup><span class="label label-primary">CRM</span></sup></a></li> -->
			        <!-- <li><a href="" ng-click="openScriptDialog()">Запустить СКРИПТ!!!111</a></li> -->
			      <!-- </ul> -->
			    <!-- </div> -->
			<!-- </div> -->
			<!-- <div class="form-group">
				<a href="" ng-href="#about/admin" class="btn btn-default" ><i class="fa fa-plus grey"></i> {{'Create Units'|translate}} <sup><span class="label label-primary">CRM</span></sup></a>
			</div> -->
			<span  translate>Filters</span>:
			<div class="form-group">
				<a href="" ng-click="resetFilter()" class="btn btn-default" title="{{'Reset all filters'|translate}}"><i class="fa fa-ban grey"></i></a>
			</div>
			<div class="form-group" ng-if="s.show.p_accounts_nm || s.custom_filter.p_accounts_nm">
				<input ng-model="s.custom_filter.p_accounts_nm" data-ng-model-options="{debounce: 150}"  class="form-control" type="text" name="" placeholder="{{'by Parent Account Name'|translate}}"  size="15">
			</div>
			<div class="form-group" ng-if="s.show.accounts_nm  || s.custom_filter.account_name " >
				<input ng-model="s.custom_filter.account_name" data-ng-model-options="{debounce: 150}"  class="form-control" type="text" name="" placeholder="{{'by Account Name'|translate}}"  size="15">
			</div>
			<div class="form-group" ng-if="s.show.crt_nm  || s.custom_filter.crt_user_nm " >
				<input ng-model="s.custom_filter.crt_user_nm" data-ng-model-options="{debounce: 150}"  class="form-control" type="text" name="" placeholder="{{'by Creator'|translate}}"  size="10">
			</div>
			<div class="form-group" ng-if="s.show.nm  || s.filter.nm " >
				<input ng-model="s.filter.nm" data-ng-model-options="{debounce: 150}"  class="form-control" type="text" name="" placeholder="{{'by Name'|translate}}"  size="10">
			</div>
			<div class="form-group" ng-if="s.show.uid  || s.filter.uid " >
				<input ng-model="s.filter.uid" data-ng-model-options="{debounce: 150}"  class="form-control" type="text" name="" placeholder="{{'by UID'|translate}}"  size="14">
			</div>
			<div class="form-group" ng-if="s.show.hw  || s.custom_filter.hw " >
				<input ng-model="s.custom_filter.hw" data-ng-model-options="{debounce: 150}"  class="form-control" type="text" name="" placeholder="{{'by HW Type'|translate}}"  size="7">
			</div>
			<div class="form-group" ng-if="s.show.ph  || s.filter.ph" >  
				<input ng-model="s.filter.ph" data-ng-model-options="{debounce: 150}"  class="form-control" type="text" name="" placeholder="{{'by Phone'|translate}}"  size="10">
			</div>
			<div class="form-group">  
				<button ng-click="showSlider()"  class="form-control" type="button" name="" title="{{'by lmsgT'|translate}}}"  ><i class="fa fa-clock-o" aria-hidden="true"></i></button>
			</div>
 			<div class="form-group">
				<select ng-model="s.limit" ng-options="value for value in [25,50,100,200,400,800,10000]" class="form-control" name="" placeholder="Limit" id="limit"></select>
			</div>
			<div class="form-group navbar-right">
			    <div class="btn-group">
					<button type="button" class="btn btn-default dropdown-toggle"  data-toggle="dropdown" title="{{'Select displayed columns'|translate}}"><i class="fa  fa-bars" aria-hidden="true"></i></button>
					<ul class="dropdown-menu my-chekbox-menu" role="menu">
						<li ng-repeat="(colname, falue) in s.show">
							<div class="checkbox" href="" ng-click="$event.stopPropagation();">
							    <label><input  ng-model="s.show[colname]" type="checkbox"  id="col_show_chk_{{$index}}"> {{('col_show_'+colname)|translate}}</label>
							 </div>		      
						</li>
					</ul>
				</div>
			</div>
  			<div ng-if="s.custom_filter.show_t" >
  				<div class="slider-container">
					<div class="col-md-1">
						<select ng-model="s.custom_filter.dt"  ng-change="onScaleChange()" ng-options="key as value.title|translate for (key , value) in slider_scales"  class="form-control" title="{{'Scale'|translate}}" name="slider_scale"  id="slider_scale"></select>
					</div>
					<div class="col-md-11">
						<div range-slider class="range-slider-custom"  min="1000*(now.ut-s.custom_filter.dt)" max="1000*now.ut" filter="date" filter-options="{{slider_scales[s.custom_filter.dt].format}}" model-min="s.custom_filter.mint" model-max="s.custom_filter.maxt" attach-handle-values="true" disabled="false"></div>
					</div>
				</div>
<!-- 				<div class="col-md-11">
					<div>
						<input ng-model="s.custom_filter.mint" my-minmaxrange="min" data-ng-model-options="{debounce: 150}" type="range" min="{{now.ut-s.custom_filter.dt}}" max="{{now.ut}}" ng-change="onTChange('min');" value="" class="form-control"> 
						<div class="range-label top" id="min"></div>
					</div>
					<div>
						<input ng-model="s.custom_filter.maxt"  my-minmaxrange="max"  data-ng-model-options="{debounce: 150}" type="range" min="{{now.ut-s.custom_filter.dt}}" max="{{now.ut}}" ng-change="onTChange('max');"  value="" class="form-control"> 
						<div class="range-label bottom"  id="max"></div>
					</div>
				</div>
 -->			
 			</div>
		</form>
	</div>
</nav>
<br>
<div class="container-fluide {{s.custom_filter.show_t?'marg-2':''}} animate-dropdown">
	<div class="table-responsive">
		<table class="table table-striped" id="items-table">
			<thead>
                <tr>
                  <!-- <th><input type="checkbox" ng-model="all_checked" ng-click="checkAll()"></th>  -->
                  <th width="50px">#</th>
                  <th ng-if="s.show.p_accounts_nm"><a href="" ng-click="setOrderBy('bpact')" ><i ng-if="s.orderby === 'bpact'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'col_show_p_accounts_nm'|translate}}</a></th>
                  <th ng-if="s.show.accounts_nm"><a href="" ng-click="setOrderBy('bact')" ><i ng-if="s.orderby === 'bact'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'ACCOUNT'|translate}}</a></th>
                  <th ng-if="s.show.crt_nm"><a href="" ng-click="setOrderBy('crt')" ><i ng-if="s.orderby === 'crt'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'CRT_USER_NAME'|translate}}</a></th>
                  <th width="32px"></th>
                  <th ng-if="s.show.nm"><a href="" ng-click="setOrderBy('nm')" ><i ng-if="s.orderby === 'nm'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'UNIT_NAME'|translate}}</a></th>
                  <th ng-if="s.show.uid"><a href="" ng-click="setOrderBy('uid')" ><i ng-if="s.orderby === 'uid'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'UID'|translate}}</a></th>
                  <th ng-if="s.show.hw"><a href="" ng-click="setOrderBy('hw')" ><i ng-if="s.orderby === 'hw'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'HW'|translate}}</a></th>
                  <th ng-if="s.show.ph"><a href="" ng-click="setOrderBy('ph')" ><i ng-if="s.orderby === 'ph'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'PHONE'|translate}}</a></th>
                  <th ng-if="s.show.ct"><a href="" ng-click="setOrderBy('ct')" ><i ng-if="s.orderby === 'ct'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'CT'|translate}}</a></th>
                  <th ng-if="s.show.lmsg_t"><a href="" ng-click="setOrderBy('lmsg.t')" ><i ng-if="s.orderby === 'lmsg.t'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'MSG_TIME'|translate}}</a></th>
                  <th ng-if="s.show.lmsg_v"><a href="" ng-click="setOrderBy('lmsg.pos.s')" ><i ng-if="s.orderby === 'lmsg.pos.s'" class="fa fa-sort-{{s.orderby_reverse ? 'asc' : 'desc'}}" aria-hidden="true"></i> {{'SPEED'|translate}}</a></th>
                  <th ng-if="s.show.online" colspan="100" >{{'ONLINE'|translate}}</th>
                </tr>
          	</thead>
          	<tbody>
				<tr ng-repeat="item in units.items | filter: s.filter | UnitsFilter: s.custom_filter : now.ut : hwtypes : accounts : users | orderBy : s.orderby : s.orderby_reverse | limitTo : s.limit : 0 as items_result track by $index" class="item-row {{item._checked?'info':''}}">
					<!-- <td><input type="checkbox" ng-model="item._checked" ng-change="onItemSelect();"></td> -->
					<td ng-bind="$index+1"></td>
					<td ng-if="s.show.p_accounts_nm" ><a href="" ng-href="#account/{{accounts.index.id[item.bact].bpact}}"  ng-bind="accounts.index.id[accounts.index.id[item.bact].bpact].nm"></a></td>
					<td ng-if="s.show.accounts_nm" ><a href="" ng-href="#account/{{item.bact}}"  ng-bind="accounts.index.id[item.bact].nm"></a></td>
					<td ng-if="s.show.crt_nm" ><a href="" ng-href="#user/{{item.crt}}"  ng-bind="users.index.id[item.crt].nm"></a></td>
					<td><img width="16px" ng-src="{{paths.request_url}}{{item.uri}}" alt=""></td>
					<td ng-if="s.show.nm" ><a href="" ng-href="#unit/{{item.id}}" ng-bind="item.nm"></a></td>
					<td ng-if="s.show.uid"  ng-bind="item.uid"></td>
					<td ng-if="s.show.hw"  nowrap ng-bind="hwtypes.index.id[item.hw].name"></td>
					<td ng-if="s.show.ph"  ng-bind="item.ph"></td>
					<td ng-if="s.show.ct"  ng-bind="item.ct*1000|date : 'dd.MM.yyyy HH:mm:ss'" nowrap></td>
					<td ng-if="s.show.lmsg_t"  ><a href="" ng-click="showMessage(item)"  ng-bind="(now.ut-item.lmsg.t) | UTtoTime" data-toggle="modal" data-target="#myModal"></a></td>
					<td ng-if="s.show.lmsg_v"  ng-bind="item.lmsg.pos.s"></td>
					<td ng-if="s.show.online" ><a  href="" ng-href="#/unit/{{item.id}}/messages" title="Go to messages"><i class="fa fa-circle {{['green','red'][1*((now.ut-item.lmsg.t)>opt.unit_online_max_interval)]}}"></i></a></td>
				</tr>
			</tbody>
		</table>
	</div>
	<nav ng-hide="!((units.items.length > s.limit)&&(items_result.length === s.limit))" class="text-center" id="paginator">
		<ul class="pagination">
			<li><a href="" ng-click="s.limit = s.limit + s.limit">{{ 'Show more n rows' | translate:{n: s.limit} }}<br><i class="fa fa-chevron-down"></i></a></li>
		</ul>
	</nav>
</div>
<!-- Modal -->
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">{{modal_item.nm}} : {{'last message'|translate}}</h4>
      </div>
      <div class="modal-body">
			<table class="table table-striped">
				<thead>
					<tr><th colspan="2">{{'position'|translate}}</th></tr>
				</thead>
				<tbody>
					<tr><td>{{'message time (UTC)'|translate}}</td><td>{{modal_item.lmsg.t*1000 | date: 'medium'}}</td></tr>
					<tr><td>{{'course'|translate}}</td><td>{{modal_item.lmsg.pos.c}}</td></tr>
					<tr><td>{{'speed'|translate}}</td><td>{{modal_item.lmsg.pos.s}}</td></tr>
					<tr><td>{{'satellites count'|translate}}</td><td>{{modal_item.lmsg.pos.sc}}</td></tr>
					<tr><td>{{'latitude'|translate}}/{{'longitude'|translate}}</td><td><a href="{{'https://yandex.ru/maps/?text='+modal_item.lmsg.pos.y+','+modal_item.lmsg.pos.x}}" target="_blank" ng-if="modal_item.lmsg.pos.x && modal_item.lmsg.pos.y">{{modal_item.lmsg.pos.y}}, {{modal_item.lmsg.pos.x}}</a></td></tr>
					<tr><td>{{'altitude'|translate}}</td><td>{{modal_item.lmsg.pos.z}}</td></tr>
				</tbody>
				<thead>
					<tr><th colspan="2">{{'parameters'|translate}}</th></tr>
				</thead>
				<tbody>
					<tr ng-repeat="(key,value) in modal_item.lmsg.p"><td>{{key}}:</td><td>{{value}}</td></tr>
				</tbody>
			</table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">{{'Close'|translate}}</button>
      </div>
    </div>
  </div>
</div>

<!-- <div id="script-dialog" class="modal fade" role="dialog"> -->
  <!-- <div class="modal-dialog modal-lg"> -->
     <!-- Modal content -->
    <!-- <div class="modal-content"> -->
      <!-- <div class="modal-header"> -->
        <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
        <!-- <h4 class="modal-title">СКРИПТ!!!111</h4> -->
      <!-- </div> -->
      <!-- <div class="modal-body"> -->
			<!-- <div class="form-group" > -->
				<!-- <input ng-model="script_dialog.symbol"  class="form-control" type="text" name="" placeholder="symbol"  size="1" maxlength="1"> -->
			<!-- </div> -->
			<!-- <div class="form-group" > -->
				<!-- <select ng-model="script_dialog.action" ng-options="value for value in ['+','-']" class="form-control" name=""></select> -->
			<!-- </div> -->
			<!-- <table class="table table-striped"> -->
				<!-- <tbody> -->
					<!-- <tr ng-repeat="item in script_dialog.items"> -->
						<!-- <td>{{item.nm}}</td> -->
						<!-- <td>{{item.uid}}</td> -->
						<!-- <td>{{item.ph}}</td> -->
						<!-- <td>{{item._result}}</td> -->
					<!-- </tr> -->
				<!-- </tbody> -->
			<!-- </table> -->
      <!-- </div> -->
      <!-- <div class="modal-footer"> -->
        <!-- <button type="button" ng-click="script_dialog.start();" class="btn btn-sucess" >Starta</button> -->
        <!-- <button type="button" class="btn btn-default" data-dismiss="modal">{{'Close'|translate}}</button> -->
      <!-- </div> -->
    <!-- </div> -->
  <!-- </div> -->
<!-- </div> -->
